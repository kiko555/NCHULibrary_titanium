var function_json=[{
		"ID": "L1.1",
		"FuncLayoutType": "h1",
		"Position":	"Left",
		"TitleText": "資訊公告",
		"FontColor": "#A4C722",
		"BgColor": "#A4C722",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "L1.2",
		"FuncLayoutType": "hr",
		"Position":	"Left",
		"TitleText": "",
		"FontColor": "#A4C722",
		"BgColor": "#A4C722",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "L1.31",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "資訊首頁",
		"FontColor": "#FFEECD",
		"BgColor": "#A4C722",
		"FunctionType": "main_page_init",
		"ShowNum": "20",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "L1.32",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "最新消息",
		"FontColor": "#FFEECD",
		"BgColor": "#A4C722",
		"FunctionType": "get_data_list",
		"ShowNum": "20",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "NormalNews"
	},{
		"ID": "L1.33",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "圖書館館訊",
		"FontColor": "#FFEECD",
		"BgColor": "#A4C722",
		"FunctionType": "open_url",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "http://www.lib.nchu.edu.tw/static_html/lib_newsletter/directory.html"
	},{
		"ID": "L2.1",
		"FuncLayoutType": "h1",
		"Position":	"Left",
		"TitleText": "館藏資源",
		"FontColor": "#F3B815",
		"BgColor": "#F3B815",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "L2.2",
		"FuncLayoutType": "hr",
		"Position":	"Left",
		"TitleText": "",
		"FontColor": "#F3B815",
		"BgColor": "#F3B815",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "L2.31",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "館藏查詢",
		"FontColor": "#FFEECD",
		"BgColor": "#F3B815",
		"FunctionType": "open_url",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "http://dds.lib.nchu.edu.tw:1701/primo_library/libweb/action/search.do?vid=mobile"
	},{
		"ID": "L2.32",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "ISBN掃描查詢",
		"FontColor": "#FFEECD",
		"BgColor": "#F3B815",
		"FunctionType": "isbn_query",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "L2.33",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "新書通報",
		"FontColor": "#FFEECD",
		"BgColor": "#F3B815",
		"FunctionType": "get_data_list",
		"ShowNum": "30",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "NewBibs"
	},{
		"ID": "L2.34",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "借閱排行榜",
		"FontColor": "#FFEECD",
		"BgColor": "#F3B815",
		"FunctionType": "open_url",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "http://www.lib.nchu.edu.tw/index.php/libpubservice/bookrank?showtype=app"
	},{
		"ID": "L3.1",
		"FuncLayoutType": "h1",
		"Position":	"Left",
		"TitleText": "我的圖書館",
		"FontColor": "#ED663D",
		"BgColor": "#ED663D",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "L3.2",
		"FuncLayoutType": "hr",
		"Position":	"Left",
		"TitleText": "",
		"FontColor": "#ED663D",
		"BgColor": "#ED663D",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "L3.31",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "借閱清單",
		"FontColor": "#FFEECD",
		"BgColor": "#ED663D",
		"FunctionType": "mylib",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "mylib_loan"
	},{
		"ID": "L3.32",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "即將到期",
		"FontColor": "#FFEECD",
		"BgColor": "#ED663D",
		"FunctionType": "mylib",
		"ShowNum": "20",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "mylib_almostover"
	},{
		"ID": "L3.33",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "借閱逾期",
		"FontColor": "#FFEECD",
		"BgColor": "#ED663D",
		"FunctionType": "mylib",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "mylib_overdue"
	},{
		"ID": "L3.34",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "預約到館",
		"FontColor": "#FFEECD",
		"BgColor": "#ED663D",
		"FunctionType": "mylib",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "mylib_request"
	},{
		"ID": "L4.1",
		"FuncLayoutType": "h1",
		"Position":	"Left",
		"TitleText": "關於本館",
		"FontColor": "#26A095",
		"BgColor": "#26A095",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "L4.2",
		"FuncLayoutType": "hr",
		"Position":	"Left",
		"TitleText": "",
		"FontColor": "#26A095",
		"BgColor": "#26A095",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "L4.31",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "開閉館時間",
		"FontColor": "#FFEECD",
		"BgColor": "#26A095",
		"FunctionType": "open_url",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "http://www.lib.nchu.edu.tw/index.php/libguide/open"
	},{
		"ID": "L4.32",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "樓層簡介",
		"FontColor": "#FFEECD",
		"BgColor": "#26A095",
		"FunctionType": "open_url",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "http://www.lib.nchu.edu.tw/index.php/libguide/floor/2012-10-12-06-45-38"
	},{
		"ID": "L4.33",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "圖書館位置",
		"FontColor": "#FFEECD",
		"BgColor": "#26A095",
		"FunctionType": "open_url",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "http://www.lib.nchu.edu.tw/index.php/libguide/traffic"
	},{
		"ID": "L4.34",
		"FuncLayoutType": "h2",
		"Position":	"Left",
		"TitleText": "相關連結",
		"FontColor": "#FFEECD",
		"BgColor": "#26A095",
		"FunctionType": "open_url",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": "http://www.lib.nchu.edu.tw/index.php/frequently-link/item/808-frequently-link"
	 },{
		"ID": "R1.1",
		"FuncLayoutType": "h1",
		"Position":	"Right",
		"TitleText": "個人化設定",
		"FontColor": "#26A095",
		"BgColor": "#26A095",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "R1.2",
		"FuncLayoutType": "hr",
		"Position":	"Right",
		"TitleText": "",
		"FontColor": "#26A095",
		"BgColor": "#26A095",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "R1.31",
		"FuncLayoutType": "h2",
		"Position":	"Right",
		"TitleText": "讀者帳號登入",
		"FontColor": "#FFEECD",
		"BgColor": "#26A095",
		"FunctionType": "personal_login",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "R1.32",
		"FuncLayoutType": "h2",
		"Position":	"Right",
		"TitleText": "通知功能開關",
		"FontColor": "#FFEECD",
		"BgColor": "#26A095",
		"FunctionType": "notification_select",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "R1.33",
		"FuncLayoutType": "h2",
		"Position":	"Right",
		"TitleText": "讀者帳號登出",
		"FontColor": "#FFEECD",
		"BgColor": "#26A095",
		"FunctionType": "personal_logout",
		"ShowNum": "0",
		"LoginCheck": "1",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "R2.1",
		"FuncLayoutType": "h1",
		"Position":	"Right",
		"TitleText": "程式設定",
		"FontColor": "#26A095",
		"BgColor": "#26A095",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "R2.2",
		"FuncLayoutType": "hr",
		"Position":	"Right",
		"TitleText": "",
		"FontColor": "#26A095",
		"BgColor": "#26A095",
		"FunctionType": "",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "R2.31",
		"FuncLayoutType": "h2",
		"Position":	"Right",
		"TitleText": "關於本程式",
		"FontColor": "#FFEECD",
		"BgColor": "#26A095",
		"FunctionType": "about_app",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "R2.32",
		"FuncLayoutType": "h2",
		"Position":	"Right",
		"TitleText": "操作說明",
		"FontColor": "#FFEECD",
		"BgColor": "#26A095",
		"FunctionType": "use_guide",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "R2.33",
		"FuncLayoutType": "h2",
		"Position":	"Right",
		"TitleText": "Email意見反饋",
		"FontColor": "#FFEECD",
		"BgColor": "#26A095",
		"FunctionType": "feedback",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	},{
		"ID": "R2.34",
		"FuncLayoutType": "h2",
		"Position":	"Right",
		"TitleText": "離開本程式",
		"FontColor": "#FFEECD",
		"BgColor": "#26A095",
		"FunctionType": "app_exit",
		"ShowNum": "0",
		"LoginCheck": "0",
		"OnOffCheck": "1",
		"ContentUrl": ""
	}];


// var function_json=[
	// {
		// ID: 'L1.1',
		// FuncLayoutType: 'h1',
		// Position:	'Left',
		// TitleText: '資訊公告',
		// FontColor: '#A4C722',
		// BgColor: '#A4C722',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L1.2',
		// FuncLayoutType: 'hr',
		// Position:	'Left',
		// TitleText: '',
		// FontColo: '#A4C722',
		// BgColor: '#A4C722',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L1.31',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '資訊首頁',
		// FontColor: '#FFEECD',
		// BgColor: '#A4C722',
		// FunctionType: 'main_page_init',
		// ContentUrl: '',
		// ShowNum: 20,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L1.32',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '最新消息',
		// FontColor: '#FFEECD',
		// BgColor: '#A4C722',
		// FunctionType: 'get_data_list',
		// ContentUrl: 'NormalNews',
		// ShowNum: 20,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L1.33',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '圖書館館訊',
		// FontColor: '#FFEECD',
		// BgColor: '#A4C722',
		// FunctionType: 'open_url',
		// ContentUrl: 'http://www.lib.nchu.edu.tw/static_html/lib_newsletter/directory.html',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L2.1',
		// FuncLayoutType: 'h1',
		// Position:	'Left',
		// TitleText: '館藏資源',
		// FontColor: '#F3B815',
		// BgColor: '#F3B815',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L2.2',
		// FuncLayoutType: 'hr',
		// Position:	'Left',
		// TitleText: '',
		// FontColor: '#F3B815',
		// BgColor: '#F3B815',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L2.31',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '館藏查詢',
		// FontColor: '#FFEECD',
		// BgColor: '#F3B815',
		// FunctionType: 'open_url',
		// ContentUrl: 'http://dds.lib.nchu.edu.tw:1701/primo_library/libweb/action/search.do?vid=mobile',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L2.32',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: 'ISBN掃描查詢',
		// FontColor: '#FFEECD',
		// BgColor: '#F3B815',
		// FunctionType: 'isbn_query',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L2.34',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '新書通報',
		// FontColor: '#FFEECD',
		// BgColor: '#F3B815',
		// FunctionType: 'get_data_list',
		// ContentUrl: 'NewBibs',
		// ShowNum: 30,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L2.35',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '借閱排行榜',
		// FontColor: '#FFEECD',
		// BgColor: '#F3B815',
		// FunctionType: 'open_url',
		// ContentUrl: 'http://www.lib.nchu.edu.tw/index.php/libpubservice/bookrank?showtype=app',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L3.1',
		// FuncLayoutType: 'h1',
		// Position:	'Left',
		// TitleText: '我的圖書館',
		// FontColor: '#ED663D',
		// BgColor: '#ED663D',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L3.2',
		// FuncLayoutType: 'hr',
		// Position:	'Left',
		// TitleText: '',
		// FontColor: '#ED663D',
		// BgColor: '#ED663D',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L3.31',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '借閱清單',
		// FontColor: '#FFEECD',
		// BgColor: '#ED663D',
		// FunctionType: 'mylib',
		// ContentUrl: 'mylib_loan',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L3.32',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '即將到期',
		// FontColor: '#FFEECD',
		// BgColor: '#ED663D',
		// FunctionType: 'mylib',
		// ContentUrl: 'mylib_almostover',
		// ShowNum: 20,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L3.33',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '借閱逾期',
		// FontColor: '#FFEECD',
		// BgColor: '#ED663D',
		// FunctionType: 'mylib',
		// ContentUrl: 'mylib_overdue',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L3.34',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '預約到館',
		// FontColor: '#FFEECD',
		// BgColor: '#ED663D',
		// FunctionType: 'mylib',
		// ContentUrl: 'mylib_request',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L4.1',
		// FuncLayoutType: 'h1',
		// Position:	'Left',
		// TitleText: '關於本館',
		// FontColor: '#26A095',
		// BgColor: '#26A095',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L4.2',
		// FuncLayoutType: 'hr',
		// Position:	'Left',
		// TitleText: '',
		// FontColor: '#26A095',
		// BgColor: '#26A095',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L4.31',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '開閉館時間',
		// FontColor: '#FFEECD',
		// BgColor: '#26A095',
		// FunctionType: 'open_url',
		// ContentUrl: 'http://www.lib.nchu.edu.tw/index.php/libguide/open',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L4.32',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '樓層簡介',
		// FontColor: '#FFEECD',
		// BgColor: '#26A095',
		// FunctionType: 'open_url',
		// ContentUrl: 'http://www.lib.nchu.edu.tw/index.php/libguide/floor/2012-10-12-06-45-38',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L4.33',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '圖書館位置',
		// FontColor: '#FFEECD',
		// BgColor: '#26A095',
		// FunctionType: 'open_url',
		// ContentUrl: 'http://www.lib.nchu.edu.tw/index.php/libguide/traffic',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'L4.34',
		// FuncLayoutType: 'h2',
		// Position:	'Left',
		// TitleText: '相關連結',
		// FontColor: '#FFEECD',
		// BgColor: '#26A095',
		// FunctionType: 'open_url',
		// ContentUrl: 'http://www.lib.nchu.edu.tw/index.php/frequently-link/item/808-frequently-link',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	 // },{
		// ID: 'R1.1',
		// FuncLayoutType: 'h1',
		// Position:	'Right',
		// TitleText: '個人化設定',
		// FontColor: '#26A095',
		// BgColor: '#26A095',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'R1.2',
		// FuncLayoutType: 'hr',
		// Position:	'Right',
		// TitleText: '',
		// FontColor: '#26A095',
		// BgColor: '#26A095',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'R1.31',
		// FuncLayoutType: 'h2',
		// Position:	'Right',
		// TitleText: '讀者帳號登入',
		// FontColor: '#FFEECD',
		// BgColor: '#26A095',
		// FunctionType: 'personal_login',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'R1.32',
		// FuncLayoutType: 'h2',
		// Position:	'Right',
		// TitleText: '通知功能開關',
		// FontColor: '#FFEECD',
		// BgColor: '#26A095',
		// FunctionType: 'notification_select',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'R1.33',
		// FuncLayoutType: 'h2',
		// Position:	'Right',
		// TitleText: '讀者帳號登出',
		// FontColor: '#FFEECD',
		// BgColor: '#26A095',
		// FunctionType: 'personal_logout',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '1',
		// OnOffCheck: '1'
	// },{
		// ID: 'R2.1',
		// FuncLayoutType: 'h1',
		// Position:	'Right',
		// TitleText: '程式設定',
		// FontColor: '#26A095',
		// BgColor: '#26A095',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'R2.2',
		// FuncLayoutType: 'hr',
		// Position:	'Right',
		// TitleText: '',
		// FontColor: '#26A095',
		// BgColor: '#26A095',
		// FunctionType: '',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'R2.31',
		// FuncLayoutType: 'h2',
		// Position:	'Right',
		// TitleText: '關於本程式',
		// FontColor: '#FFEECD',
		// BgColor: '#26A095',
		// FunctionType: 'about_app',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'R2.32',
		// FuncLayoutType: 'h2',
		// Position:	'Right',
		// TitleText: '操作說明',
		// FontColor: '#FFEECD',
		// BgColor: '#26A095',
		// FunctionType: 'use_guide',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'R2.33',
		// FuncLayoutType: 'h2',
		// Position:	'Right',
		// TitleText: 'Email意見反饋',
		// FontColor: '#FFEECD',
		// BgColor: '#26A095',
		// FunctionType: 'feedback',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// },{
		// ID: 'R2.34',
		// FuncLayoutType: 'h2',
		// Position:	'Right',
		// TitleText: '離開本程式',
		// FontColor: '#FFEECD',
		// BgColor: '#26A095',
		// FunctionType: 'app_exit',
		// ContentUrl: '',
		// ShowNum: 0,
		// LoginCheck: '0',
		// OnOffCheck: '1'
	// }
// ];


exports.db_check = function() {
	Ti.API.info("--------------------------------------------------------------------------\n＃＃＃＃　NCHULIB-APP: 執行function(db_check) 資料庫存在與否檢測\n--------------------------------------------------------------------------\n");
	// var function_json_string = JSON.stringify(function_json);
	// alert(function_json_string);
	// alert(function_json[1]);
	
	try{
		var rs = NchuLibdb.execute('SELECT UserToken, PID, UseTimes FROM APP_tab_User WHERE length(UserToken)>10');

		Ti.App.Properties.setString('UserToken', rs.fieldByName('UserToken'));
		// Ti.API.info("＃＃＃＃　NCHULIB-APP: 資料庫存在與否檢測: 資料庫存在，設定全域變數UserToken: "+Ti.App.Properties.getString('UserToken'));
		Ti.App.Properties.setString('PID', rs.fieldByName('PID'));
		// Ti.API.info("＃＃＃＃　NCHULIB-APP: 資料庫存在與否檢測: 資料庫存在，設定全域變數PID: "+Ti.App.Properties.getString('PID'));

		var update_UseTimes_sql = "UPDATE APP_tab_User SET UseTimes=UseTimes+1;";
		NchuLibdb.execute(update_UseTimes_sql);
		Ti.App.Properties.setInt('UseTimes', rs.fieldByName('UseTimes')+1);
		
		Ti.API.info("=============================================================\n＃＃＃＃　NCHULIB-APP: 檢查讀者推播ID，UserToken已註冊: "+Ti.App.Properties.getString('UserToken')+"\n=============================================================");
		rs.close();
		
	// NchuLibdb.remove();
	// Ti.API.info("刪除資料庫");
	// var NchuLibdb = Ti.Database.open('NchuLibDB');
	}catch(err){	// 資料表不存在的話，建立資料表。
		// Ti.API.info("＃＃＃＃　NCHULIB-APP: 資料庫存在與否檢測: 「資料庫不存在」或是「UserToken未取得」。");
		// Ti.API.info("＃＃＃＃　NCHULIB-APP: 資料庫存在與否檢測: 不管資料是否存在，視為初始安裝，清空資料庫。");
		NchuLibdb.remove();
		//NchuLibdb = null;
		NchuLibdb = Ti.Database.open('NchuLibDB');

		// Ti.API.info("＃＃＃＃　NCHULIB-APP: 資料庫存在與否檢測: 創建資料庫及資料表。");
	   
		// 系統功能資料表
		NchuLibdb.execute("CREATE TABLE IF NOT EXISTS APP_tab_Function(
			ID TEXT, 
			FuncLayoutType TEXT, 
			Position TEXT, 
			TitleText TEXT,
			FontColor TEXT,
			BgColor TEXT,  
			FunctionType TEXT, 
			ContentUrl TEXT, 
			ShowNum INTEGER, 
			LoginCheck TEXT, 
			OnOffCheck TEXT
		);");
		
		// Ti.API.info("＃＃＃＃　NCHULIB-APP: 清除左右邊功能表資料。");
		NchuLibdb.execute("DELETE FROM APP_tab_Function;");
		
		// 寫入系統功能表資料
		for(var i=0; i<function_json.length; i++){
			NchuLibdb.execute("INSERT INTO APP_tab_Function VALUES(
				'"+function_json[i]['ID']+"',
				'"+function_json[i]['FuncLayoutType']+"', 
				'"+function_json[i]['Position']+"', 
				'"+function_json[i]['TitleText']+"', 
				'"+function_json[i]['FontColor']+"',
				'"+function_json[i]['BgColor']+"',
				'"+function_json[i]['FunctionType']+"', 
				'"+function_json[i]['ContentUrl']+"', 
				"+function_json[i]['ShowNum']+", 
				'"+function_json[i]['LoginCheck']+"', 
				'"+function_json[i]['OnOffCheck']+"'
			);");
		}
/*
		var rs = NchuLibdb.execute("SELECT * FROM APP_tab_Function;");
		while (rs.isValidRow()){
			Ti.API.info('ID:\t\t\t'+rs.fieldByName('ID')+'\n'+
						'FuncLayoutType:\t'+rs.fieldByName('FuncLayoutType')+'\n'+
						'Position:\t\t'+rs.fieldByName('Position')+'\n'+
						'TitleText:\t\t'+rs.fieldByName('TitleText')+'\n'+
						'FontColor:\t\t'+rs.fieldByName('FontColor')+'\n'+
						'BgColor:\t\t'+rs.fieldByName('BgColor')+'\n'+
						'FunctionType:\t'+rs.fieldByName('FunctionType')+'\n'+
						'ContentUrl:\t\t'+rs.fieldByName('ContentUrl')+'\n'+
						'ShowNum:\t\t'+rs.fieldByName('ShowNum')+'\n'+
						'LoginCheck:\t\t'+rs.fieldByName('LoginCheck')+'\n'+
						'OnOffCheck:\t\t'+rs.fieldByName('OnOffCheck')+"\n-------------------------------------------\n");
			rs.next();
		}
		rs.close();
*/		
		
		
		// 讀者資料表
		NchuLibdb.execute("CREATE TABLE IF NOT EXISTS APP_tab_User(
			UserToken TEXT, 
			PID TEXT, 
			PatronBarCode TEXT,
			BorStatus TEXT,
			BorType TEX,
			UseTimes INTEGER
		);");

		// 內容資料表
		NchuLibdb.execute("CREATE TABLE IF NOT EXISTS APP_tab_Data(
			InfoType TEXT, 
			InfoData TEXT, 
			StatusCheckCode TEXT, 
			UpdateTime TEXT, 
			NotificationCheck TEXT
		);");
		
	   	// 寫入最新消息通知資訊
	   	NchuLibdb.execute("INSERT INTO APP_tab_Data VALUES('NormalNews','','','"+common.getNowTime()+"','1');");
	   	// 寫入新書通報通知資訊
	   	NchuLibdb.execute("INSERT INTO APP_tab_Data VALUES('NewBibs','','','"+common.getNowTime()+"','0');");

		// 系統紀錄表
		// NchuLibdb.execute("CREATE TABLE IF NOT EXISTS APP_tab_SystemLog(
			// ID INTEGER PRIMARY KEY, 
			// JobType TEXT, 
			// StartTime TEXT, 
			// EndTime TEXT, 
			// ExecuteStatus TEXT
		// );");
	}
};

exports.user_reg = function() {
	Ti.API.info("--------------------------------------------------------------------------\n＃＃＃＃　NCHULIB-APP: 執行function(user_reg) 進行使用者資料註冊\n--------------------------------------------------------------------------\n");
	
	// 要補一段取得CloudMessageID
	// var var_UserToken = Titanium.Utils.md5HexDigest((var_CloudMessageID+"_"+get_rnd_string(20)));
	var var_OSType = Titanium.Platform.osname;
	// if(var_OSType=='android'){
		// var var_UserToken = UserToken;
	// }else if(var_OSType=='iphone' || var_OSType=='ipad'){
		// var var_UserToken = UserToken;
	// }
	// var var_UserToken = UserToken;
	var var_UserToken = Ti.App.Properties.getString('UserToken');
	
	if(var_UserToken.length>30){
		// Ti.API.info("＃＃＃＃　NCHULIB-APP: 成功取得UserToken.");
		
		var var_OSVersion = Titanium.Platform.version;
		var var_Brand = Titanium.Platform.manufacturer;
		var var_Model = Titanium.Platform.model;
		var var_DeviceLocale = Titanium.Locale.currentLocale;
		var var_Resolution = sWidth+"x"+sHeight;
		var var_APPVersion = Titanium.App.version;
		
		try{
		   	// 寫入UserToken
		   	NchuLibdb.execute("INSERT INTO APP_tab_User VALUES('"+var_UserToken+"','','','','',1);");
		   	Ti.App.Properties.setInt('UseTimes', 1);
		   	
			// Ti.API.info("＃＃＃＃　NCHULIB-APP: 載具端使用者資料寫入成功!");
			
			//回傳使用者資料到Agent進行註冊
			var url = "https://www.lib.nchu.edu.tw/lib_api/php/appagent/index_get_2014.php?OP=Reg&UserToken="+var_UserToken+"&DeviceInfo={\"OSType\":\""+var_OSType+"\",\"OSVersion\":\""+var_OSVersion+"\",\"Brand\":\""+var_Brand+"\",\"Model\":\""+var_Model+"\",\"DeviceLocale\":\""+var_DeviceLocale+"\",\"Resolution\":\""+var_Resolution+"\",\"APPVersion\":\""+var_APPVersion+"\"}";
			
			// Ti.API.info("＃＃＃＃　NCHULIB-APP: 回傳使用者資料到Agent進行註冊url: "+url);
			var xhr = Ti.Network.createHTTPClient({
				onload : function(e) {
					// Ti.API.info("＃＃＃＃　NCHULIB-APP: 伺服器端讀者資料註冊成功!");
					// Ti.API.info("＃＃＃＃　NCHULIB-APP: 伺服器端讀者資料註冊成功後回傳的資料: "+this.responseText);
					// json = JSON.parse(this.responseText);
				},
				onerror : function(e) {
					// Ti.API.debug(e.error);
					// Ti.API.info("＃＃＃＃　NCHULIB-APP: 伺服器端讀者資料註冊失敗!");
	 			},
	 			timeout : 10000
	 		});
	 		xhr.validatesSecureCertificate=false;
	 		xhr.open("GET", url);
			xhr.send();
			// while (xhr.readyState!=4) {}
	
		}catch(err_info){
			// Ti.API.info("＃＃＃＃　NCHULIB-APP: 載具端使用者資料寫入異常!"+err_info);
		}
	}else{
		// Ti.API.info("＃＃＃＃　NCHULIB-APP: UserToken取得失敗.");
	}
}

// function get_android_CMID(){
	// return get_rnd_string(60);
// }
// 
// function get_ios_CMID(){
	// return get_rnd_string(60);
// }

exports.get_rnd_string = function(string_length) {
	var rnd_string="";
	while (rnd_string.length<string_length){
		switch(Math.round(Math.random()*2)){
 		case 0:
 			rnd_string += String.fromCharCode(Math.round(65+(Math.random()*(90-65))));
			break;
 		case 1:
 			rnd_string += String.fromCharCode(Math.round(97+(Math.random()*(122-97))));
			break;
 		case 2:
 			rnd_string += String.fromCharCode(Math.round(48+(Math.random()*(57-48))));
			break;		
		}		
	}
	return rnd_string;
}


exports.error_alert = function(error_type, error_string) {
		switch(error_type){
 		case "network":
			var msg = Ti.UI.createNotification({message:'\n抱歉，無法透過網路進行'+error_string+'，請您確認網路連線功能是否正常。\n', duration: Ti.UI.NOTIFICATION_DURATION_SHORT});
			msg.show();
			// Ti.API.info("＃＃＃＃　NCHULIB-APP: 伺服器端 "+error_type+" 資料更新失敗。");
			break;
		}	
}


exports.check_net_state = function(alert_string) {
	alert_string = alert_string || '';
	if(Titanium.Network.online){
		return true;
	}else{
		if(alert_string!=''){
			var alert_dialog = Ti.UI.createAlertDialog({
				cancel: 0,
				buttonNames: ['確認'],
				message: '\n'+alert_string+'\n',
				title: '網路連線失敗'
			});
			alert_dialog.show();
			// Ti.API.info("＃＃＃＃　NCHULIB-APP: 網路狀態檢測: "+alert_dialog);
		}
		return false;	
	}
}


exports.ISBN10toISBN13 = function(isbn10) {
	var sum = 38 + 3 * (parseInt(isbn10[0]) + parseInt(isbn10[2]) + parseInt(isbn10[4]) + parseInt(isbn10[6]) + parseInt(isbn10[8])) + parseInt(isbn10[1]) + parseInt(isbn10[3]) + parseInt(isbn10[5]) + parseInt(isbn10[7]);
    var checkDig = (10 - (sum % 10)) % 10;
    return "978" + isbn10.substring(0, 9) + checkDig;
}
 

exports.ISBN13toISBN10 = function(isbn13) {
	var start = isbn13.substring(3, 12);
	var sum = 0;
	var mul = 10;
	var i;
	for(i = 0; i < 9; i++) {
		sum = sum + (mul * parseInt(start[i]));
		mul -= 1;
	}
	var checkDig = 11 - (sum % 11);
	if (checkDig == 10) {
	    checkDig = "X";
	} else if (checkDig == 11) {
	    checkDig = "0";
	}
	return start + checkDig;
}


exports.getNowTime = function(){
	var currentTime = new Date();
	var year = currentTime.getFullYear();
	var month = currentTime.getMonth() + 1;
	var day = currentTime.getDate();
	var hours = currentTime.getHours();
	var minutes = currentTime.getMinutes();
	var seconds = currentTime.getSeconds();
	
	return year+"-"+month+"-"+day+" "+hours+":"+minutes+":"+seconds;
}

exports.decodeUrlParameter = function(str){
	return decodeURIComponent(str.replace(/\+/g, '%20'));
}

exports.getInfoData = function(InfoType, WaitingFlag){
	if (common.check_net_state()){
	    switch(InfoType){
		case "All":
			break;
		case 'NormalNews': case 'NewBibs': case 'LOAN': case 'REQUEST':
			try{
				var error_string = '';
			    switch(InfoType){
				case 'NormalNews':
					error_string = '最新消息資料更新';
					break;
				case 'NewBibs':
					error_string = '新書通報資料更新';
					break;
				case 'LOAN':
					error_string = '借閱資料更新';
					break;
				case 'REQUEST':
					error_string = '預約到館資料更新';
					break;
				}
				var url = "https://www.lib.nchu.edu.tw/lib_api/php/appagent/index_get_2014.php?OP=GetInfoData&UserToken="+Ti.App.Properties.getString('UserToken')+"&InfoType="+InfoType+"&AppVersion="+Titanium.App.version;
				Ti.API.info("＃＃＃＃　NCHULIB-APP: 開始擷取"+InfoType+"資料: "+url);
				var xhr = Ti.Network.createHTTPClient({
					onload : function(e) {
						// Ti.API.info("＃＃＃＃　NCHULIB-APP: 回傳資料: " + this.responseText);
						json = JSON.parse(this.responseText);
						
						if(json.Status.AuthResult=='Success'){
							var rs = NchuLibdb.execute("SELECT * FROM APP_tab_Data WHERE InfoType='"+InfoType+"';");
							if (rs.isValidRow()){
								var update_sql = "UPDATE APP_tab_Data SET InfoData='"+json.InfoData+"', UpdateTime='"+common.getNowTime()+"' WHERE InfoType='"+InfoType+"';";
								NchuLibdb.execute(update_sql);
								// Ti.API.info("＃＃＃＃　NCHULIB-APP: 更新"+InfoType+"資料至載具資料庫: "+update_sql);
							}else{
								var insert_sql = "INSERT INTO APP_tab_Data VALUES('"+InfoType+"','"+json.InfoData+"','','"+common.getNowTime()+"','1');";
								NchuLibdb.execute(insert_sql);
								// Ti.API.info("＃＃＃＃　NCHULIB-APP: 新增"+InfoType+"資料類型至載具資料庫: "+insert_sql);
							}
							rs.close();
							
							Ti.App.Properties.setString('AppStableVersion', json.Status.AppStableVersion);
				
							// Ti.API.info("＃＃＃＃　NCHULIB-APP: 完成"+InfoType+"資料更新。\n===============================================================");
							// var msg = Ti.UI.createNotification({message:"完成資料更新", duration: Ti.UI.NOTIFICATION_DURATION_SHORT});
							// msg.show();
						}else{
							// var msg = Ti.UI.createNotification({message:"資料更新失敗", duration: Ti.UI.NOTIFICATION_DURATION_SHORT});
							// msg.show();
							// Ti.API.info("＃＃＃＃　NCHULIB-APP: "+InfoType+"資料更新失敗。認證失敗。\n===============================================================");
						}
					},
					onerror : function(e) {
						common.error_alert("network", error_string);
		 			},
				    // onreadystatechange : function(e) {
				        // Ti.API.info("-----------------------");
				        // Ti.API.info("[onreadystatechange]readyState:" + xhr.readyState);
				    // },
		 			timeout : 10000
		 		});
		 		xhr.validatesSecureCertificate=false;
		 		xhr.open("GET", url);
				xhr.send();
				// if(WaitingFlag==1){
					// Ti.API.info("＃＃＃＃　NCHULIB-APP: *********** 等待 "+InfoType+" 資料更新。 ***********: "+common.getNowTime());
					// while (xhr.readyState!=4) {}
					// Ti.API.info("＃＃＃＃　NCHULIB-APP: *********** 完成 "+InfoType+" 資料更新。 ***********: "+common.getNowTime());
				// }
			}catch(err_info){
				var msg = Ti.UI.createNotification({message:error_string+'失敗', duration:Ti.UI.NOTIFICATION_DURATION_SHORT});
				msg.show();
				// Ti.API.info("＃＃＃＃　NCHULIB-APP: "+InfoType+"資料更新失敗，錯誤訊息: "+err_info);
			}
			break;
		}
		Ti.API.info("＃＃＃＃　NCHULIB-APP: 完成擷取"+InfoType+"資料: "+url);
	}
}
